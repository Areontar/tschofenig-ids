



Network Working Group                                        J. Peterson
Internet-Draft                                             NeuStar, Inc.
Intended status: Informational                            H. Schulzrinne
Expires: November 27, 2013                           Columbia University
                                                           H. Tschofenig
                                                  Nokia Siemens Networks
                                                            May 26, 2013


   Secure Origin Identification: Problem Statement, Requirements, and
                                Roadmap
                 draft-peterson-secure-origin-ps-00.txt

Abstract

   Over the past decade, SIP has become a major signaling protocol for
   voice communications, one which has replaced many traditional
   telephony deployments.  However, interworking SIP with the
   traditional telephone network has ultimately reduced the security of
   Caller ID systems.  Given the widespread interworking of SIP with the
   telephone network, the lack of effective standards for identifying
   the calling party in a SIP session has granted attackers new powers
   as they impersonate or obscure calling party numbers when
   orchestrating bulk commercial calling schemes, hacking voicemail
   boxes or even circumventing multi-factor authentication systems
   trusted by banks.  This document therefore examines the reasons why
   providing identity for telephone numbers on the Internet has proven
   so difficult, and shows how changes in the last decade may provide us
   with new strategies for attaching a secure identity to SIP sessions.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on November 27, 2013.





Peterson, et al.       Expires November 27, 2013                [Page 1]

Internet-Draft        Secure Origin Identification              May 2013


Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3
   2.  The Problem . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Use Cases . . . . . . . . . . . . . . . . . . . . . . . . . .   4
     3.1.  IP-to-IP Communication Use Case . . . . . . . . . . . . .   5
     3.2.  IP-PSTN-IP Use Case . . . . . . . . . . . . . . . . . . .   5
     3.3.  PSTN-to-IP Case . . . . . . . . . . . . . . . . . . . . .   6
     3.4.  IP-to-PSTN Use Case . . . . . . . . . . . . . . . . . . .   7
     3.5.  PSTN-IP-PSTN Use Case . . . . . . . . . . . . . . . . . .   8
   4.  Limitations of Current Solutions  . . . . . . . . . . . . . .   9
     4.1.  SIP Identity  . . . . . . . . . . . . . . . . . . . . . .   9
     4.2.  VIPR  . . . . . . . . . . . . . . . . . . . . . . . . . .  12
   5.  Environmental Changes . . . . . . . . . . . . . . . . . . . .  14
     5.1.  Shift to Mobile Communication . . . . . . . . . . . . . .  14
     5.2.  Failure of Public ENUM  . . . . . . . . . . . . . . . . .  14
     5.3.  Public Key Infrastructure Developments  . . . . . . . . .  15
     5.4.  Pervasive Nature of B2BUA Deployments . . . . . . . . . .  15
     5.5.  Stickiness of Deployed Infrastructure . . . . . . . . . .  16
     5.6.  Evolution with Numbering  . . . . . . . . . . . . . . . .  16
   6.  Requirements  . . . . . . . . . . . . . . . . . . . . . . . .  16
   7.  Roadmap . . . . . . . . . . . . . . . . . . . . . . . . . . .  17
   8.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .  17
   9.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  17
   10. Security Considerations . . . . . . . . . . . . . . . . . . .  17
   11. Informative References  . . . . . . . . . . . . . . . . . . .  17
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  19









Peterson, et al.       Expires November 27, 2013                [Page 2]

Internet-Draft        Secure Origin Identification              May 2013


1.  Introduction

   In many communication architectures that allow users to communicate
   with other users the need for identifying the originating party that
   initiates a call or a messaging interaction arises.  The desire for
   identifying the communication parties in the end-to-end communication
   attempt arises from the need to implement authorization policies (to
   grant or reject call attempts) but has also been utilized for
   charging.  While there are a number of ways to enable identification
   this functionality has been provided by the Session Initiation
   Protocol (SIP) [RFC3261] by using two main types of approaches,
   namely using P-Asserted-Identity (PAI) [RFC3325] and SIP Identity
   [RFC4474], which are described in more detail in Section 4.  The goal
   of these mechanisms is to validate that originator of a call is
   authorized to use the From identifier.  Protocols, like XMPP, use
   mechanisms that are conceptional similar to those offered by SIP.

   Although solutions have been standardized it turns out that the
   current deployment situation is unsatisfactory and, even worse, there
   is little indication that it will be improve in the future.  In
   [I-D.cooper-iab-secure-origin] we illustrate what challenges arise.
   In particular, the interworking with different communication
   architectures (e.g., SIP, PSTN, XMPP, RTCWeb) breaks the end-to-end
   semantic of the communication interaction and destroys the
   identification capabilities.  Furthermore, the use of different
   identifiers (e.g., E.164 numbers vs.  SIP URIs) creates challenges
   for determining who is able to claim "ownership" for a specific
   identifier.

   After the publication of the PAI and SIP Identity specifications
   various further attempts have been made to tackle the topic but
   unfortunately with little success.  The complexity resides in the
   deployment situation and the long list of (often conflicting)
   requirements.  A number of years have passed since the last attempts
   were made to improve the situation and we therefore believe it is
   time to give it another try.  With this document we would like to
   start an attempt to develop a common understanding of the problem
   statement as well as requirements to develop a vision on how to
   advance the state of the art and to initiate technical work to enable
   secure call origin identification.

2.  The Problem

   The PSTN builds on a walled garden with a chain-of-trust security
   model.  This is a convenient assumption as long as the participating
   parties are indeed well-behaving.  Unfortunately, this is not true
   anymore (and has not been the case for a long time already).  Caller
   ID spoofing is common and even transit providers are not trustworthy



Peterson, et al.       Expires November 27, 2013                [Page 3]

Internet-Draft        Secure Origin Identification              May 2013


   either.  Some parties are leveraging the lack of Caller ID in the SIP
   world to launch bulk commercial telephone calls (commonly
   "robocalling", see, for example, the FCC webpage [robocall]) in the
   traditional telephone network, which are difficult to block or trace
   due to the lack of identity conveyed through the SIP-PSTN
   interworking deployments.

   For example, a recent telephony denial-of-service attack against
   emergency communications centers have created some press attention
   [TDOS].  In this specific case the extortion scheme starts with a
   phone call to an organization from an individual claiming to
   represent a collections company for payday loans.  Failing to get
   payment from an individual or organization, an attack is launched
   with a high volume of calls utilizing spoofed phone numbers, which
   ties up the target system from receiving legitimate calls.  Robocalls
   is a problem that has been recognized already by various regulators,
   for example the FCC recently organized a robocall competition to
   solicit ideas for creating solutions that will block illegal
   robocalls [robocall-competition].  Similarly, the News International
   phone-hacking scandal [news-hack] has also gained a lot of press
   attention where employees of the newspaper were accused of engaging
   in phone hacking by utilizing Caller ID spoofing to get access to a
   voice mail boxes.

   Not all forms of Caller ID spoofing are, however, malicious.  There
   are at least two common legitimate cases of Caller ID spoofing that
   need to be taken into account that constrain the solution space:

   The Doctor's Office:  Doctors calling their patients using their cell
      phones would like to replace their mobile phone number with the
      number of their office to avoid receiving callbacks from patients
      during out-of-office hours.

   Call Centers:  Call centers operate on behalf of companies and the
      called party expects to see the Caller ID of the company

3.  Use Cases

   In order to explain the requirements and other design assumptions we
   will explain some of the scenarios that need to be supported by any
   solutions.  Note that the figures do not show the VSPs infrastructure
   equipment (like proxies) editorial reasons.









Peterson, et al.       Expires November 27, 2013                [Page 4]

Internet-Draft        Secure Origin Identification              May 2013


3.1.  IP-to-IP Communication Use Case

   The first use case is that of a call that originates and terminates
   on the IP network without ever touching the PSTN but that uses E.164
   numbers instead of a SIP URI.  This case is quite prevalent today in
   some of the private peering federations.  Since these federations are
   being used in conjunction with the PSTN it is quite logical that the
   addressing will be E.164 and not SIP URI based.  The use of E.164
   numbers (unlike SIP URIs that have a username and a domain component)
   changes the authorization model.

   As can be seen in Figure 1 if Alice calls Bob the call will be IP
   based end-to-end.

            +------------+
            |  IP-based  |
            |  SIP Phone |<--+
            |  of Bob    |   |
            |+19175551234|   |
            +------------+   |
                             |
   +------------+            |
   |  IP-based  |            |
   |  SIP Phone |       ------------
   |  of Alice  |      /     |      \
   |+12121234567|    //      |       \\
   +------------+   //      ,'        \\\
       |          ///      /             -----
       |       ////      ,'                  \\\\
       |      /        ,'                        \
       |     |       ,'                           |
       +---->|......:       IP-based              |
             |              Network               |
              \                                  /
               \\\\                         ////
                   -------------------------

                       Figure 1: IP-to-IP Use Case.

3.2.  IP-PSTN-IP Use Case

   In this use case Dan's VSP is not a member of the federation Alice's
   and Bob's VSP belongs to.  As far as Alice is concerned Dan is not
   accessible via IP and the PSTN is used as an interconnection network.
   Figure 2 shows the resulting exchange.

                                        --------
                                    ////        \\\\



Peterson, et al.       Expires November 27, 2013                [Page 5]

Internet-Draft        Secure Origin Identification              May 2013


                             +--- >|      PSTN      |
                             |     |                |
                             |      \\\\        ////
                             |          --------
                             |             |
                             |             |
                             |             |
   +------------+         +--+----+        |
   |  IP-based  |         | PSTN  |        |
   |  SIP Phone |       --+ VoIP  +-       v
   |  of Alice  |      /  |  GW   | \  +---+---+
   |+12121234567|    //    `'''''''  \\| PSTN  |
   +------------+   //       |        \+ VoIP  +
       |          ///        |         |  GW   |\
       |       ////          |          `'''''''\\      +------------+
       |      /              |             |     \      |  IP-based  |
       |     |               |             |      |     |   Phone    |
       +---->|---------------+             +------|---->|  of Dan    |
             |                                    |     |+12039994321|
              \             IP-based             /      +------------+
               \\\\         Network         ////
                   -------------------------

                      Figure 2: IP-PSTN-IP Use Case.

3.3.  PSTN-to-IP Case

   Consider Figure 3 where Carl is using a PSTN phone and initiates
   calls to Alice.  Alice is using an IP-based phone.  The call of Carl
   traverses the PSTN and enters the Internet via some PSTN/VoIP
   gateway.  This gateway attaches some identity information to the call
   (for example based on the information it had received through the
   PSTN, if available).

               --------
           ////        \\\\
       +->|      PSTN      |--+
       |  |                |  |
       |   \\\\        ////   |
       |       --------       |
       |                      |
       |                      v
       |                 +----+-------+
   +---+------+          |PSTN / VoIP |              +-----+
   |PSTN Phone|          |Gateway     |              |SIP  |
   |of Carl   |          +----+-------+              |UA   |
   +----------+               |                      |Alice|
                            Invite                   +-----+



Peterson, et al.       Expires November 27, 2013                [Page 6]

Internet-Draft        Secure Origin Identification              May 2013


                              |                         ^
                              V                         |
                       +---------------+              Invite
                       |VoIP           |                |
                       |Interconnection|   Invite   +-------+
                       |Provider(s)    |----------->+       |
                       +---------------+            |Alice's|
                                                    |VSP    |
                                                    |       |
                                                    +-------+

                      Figure 3: PSTN-to-IP Use Case.

   Note: A B2BUA/Session Border Controller (SBC) would exhibit behavior
   that looks similar to this scenario since the original call content
   would, in the worst case, be re-built entirely (except for the
   destination number, which might be changed afterwards due to
   retargeting).

3.4.  IP-to-PSTN Use Case

   Consider Figure 4 where Alice calls Carl.  Carl uses a PSTN phone and
   Alice an IP-based phone.  When Alice initiates the call the E.164
   number needs to get translated to a SIP URI and subsequently to an IP
   address.  The call of Alice traverses her VoIP provider where the
   call origin identification information is added.  It then hits the
   PSTN/VoIP gateway.  Ideally, Alice would like to know whether she,
   for example, talks to someone at her bank rather than to someone
   intercepting the call.  If Alice wants to be assured that she's being
   connected to the right party, it is a slightly different aspect to
   what [RFC3325][RFC4474].  Problem statements and solutions are
   offered with [I-D.peterson-sipping-retarget] and [RFC4916].

     +-------+                                        +-----+  -C
     |PSTN   |                                        |SIP  |  |a
     |Phone  |<----------------+                      |UA   |  |l
     |of Carl|                 |                      |Alice|  |l
     +-------+                 |                      +-----+  |i
                ---------------------------              |     |n
            ////                           \\\\          |     |g
           |               PSTN                |       Invite  |
           |                                   |         |     |P
            \\\\                           ////          |     |a
                ---------------------------              |     |r
                               ^                         |     |t
                               |                         v     |y
                          +------------+             +--------+|
                          |PSTN / VoIP |<--Invite----|VoIP    ||D



Peterson, et al.       Expires November 27, 2013                [Page 7]

Internet-Draft        Secure Origin Identification              May 2013


                          |Gateway     |             |Service ||o
                          +------------+             |Provider||m
                                                     |of Alice||a
                                                     +--------+|i
                                                               -n

                      Figure 4: IP-to-PSTN Use Case.

3.5.  PSTN-IP-PSTN Use Case

   Consider Figure 5 where Carl calls Alice.  Both users have PSTN
   phones but interconnection between the two PSTN networks is
   accomplished via an IP network.  Consequenly, Carl's operator uses a
   PSTN-to-VoIP gateway to route the call via an IP network to a gateway
   to break out into the PSTN again.

                                                     +----------+
                                                     |PSTN Phone|
               --------                              |of Alice  |
           ////        \\\\                          +----------+
       +->|      PSTN      |------+                       ^
       |  |                |      |                       |
       |   \\\\        ////       |                       |
       |       --------           |                    --------
       |                          v                ////        \\\\
       |                       ,-------+          |      PSTN      |
       |                       |PSTN   |          |                |
   +---+------+              __|VoIP GW|_          \\\\        ////
   |PSTN Phone|             /  '`''''''' \             --------
   |of Carl   |           //      |       \\              ^
   +----------+          //       |        \\\            |
                       ///        -. INVITE   -----       |
                    ////            `-.           \\\\    |
                   /                   `..            \   |
                  |    IP-based           `._       ,--+----+
                  |    Network               `.....>|VoIP   |
                  |                                 |PSTN GW|
                   \                                '`'''''''
                    \\\\                         ////
                        -------------------------

                      Figure 5: IP-to-PSTN Use Case.









Peterson, et al.       Expires November 27, 2013                [Page 8]

Internet-Draft        Secure Origin Identification              May 2013


4.  Limitations of Current Solutions

   From the inception of SIP, the From header field value has held an
   arbitrary user-supplied identity, much like the From header field
   value of an email message.  During work on [RFC3261], efforts began
   to provide a secure origin for SIP requests as an extension to SIP.
   The so-called "short term" solution, the P-Asserted-Identity header
   described in [RFC3325], has had the largest impact on deployments to
   date, though its applicability is limited to closed trusted networks
   where end-user devices cannot alter or inspect SIP messages.
   Unfortunately, as P-Asserted-Identity use has become more popular,
   its applicability has grown murkier.

   Subsequent efforts to prevent calling identity spoofing in SIP
   include the SIP Identity effort (the "long term" identity solution)
   and Verification Involving PSTN Reachability (VIPR).  SIP Identity
   focused on attaching a new header to SIP requests with a signature
   over the From header field value in way that prevented replay
   attacks.  The VIPR architecture attacked a broader suite of problems
   relating to spam, routing and identity with a new infrastructure for
   managing rendezvous and security which operated alongside of SIP
   deployments.

4.1.  SIP Identity

   The SIP Identity mechanism [RFC4474] provided two header fields for
   securing identity information in SIP requests: the Identity and
   Identity-Info header fields.  Architecturally, the SIP Identity
   mechanism assumes a classic "SIP trapezoid" deployment in which an
   authentication service, acting on behalf of the originator of a SIP
   request, attaches identity information to the request which provides
   partial integrity protection; a verification service acting on behalf
   of the recipient validates the integrity of the request when it is
   received.

   The Identity header field value contains a signature over a hash of
   selected elements of a SIP request, including several header field
   values (most significantly, the From header field value) and the
   entirety of the body of the request.  The set of header field values
   was chosen specifically to prevent cut-and-paste attacks; it requires
   the verification service to retain some state to guard against
   replays.  The signature over the body of a request has different
   properties for different SIP methods, but all prevent tampering by
   man-in-the-middle attacks.  For a SIP MESSAGE request, for example,
   the signature over the body covers the actual message conveyed by the
   request: it is pointless to guarantee the source of a request if a
   man-in-the-middle can change the content of the message, as in that
   case the message content is created by an attacker.  Similar threats



Peterson, et al.       Expires November 27, 2013                [Page 9]

Internet-Draft        Secure Origin Identification              May 2013


   exist against the SIP NOTIFY method.  For a SIP INVITE request, a
   signature over the SDP body is intended to prevent a man-in-the-
   middle from changing properties of the media stream, including the IP
   address and port to which media should be sent, as this provides a
   means for the man-in-the-middle to direct session media to resource
   that the originator did not specify, and thus to impersonate an
   intended listener.

   The Identity-Info header field value contains a URI designating the
   location of the certificate corresponding to the private key that
   signed the hash in the Identity header.  That certificate could be
   passed by-value along with the SIP request, in which case a "cid" URI
   appears in Identity-Info, or by-reference, for example when the
   Identity-Info header field value has the URL of a web service that
   delivers the certificate.  [RFC4474] levies further constraints
   governing the subject of that certificate: namely, that it must cover
   the domain name indicated in the domain component of the URI in the
   From header field value of the request.

   The SIP Identity mechanism, however, has two fundamental limitations
   that have precluded its deployment: first, that it provides Identity
   only for domain name rather than other identifiers; second, that it
   does not tolerate intermediaries that alter the bodies, or certain
   header fields, of SIP requests.

   As deployed, SIP predominantly mimics the structures of the telephone
   network, and thus uses telephone numbers as identifiers.  Telephone
   numbers in the From header field value of a SIP request may appear as
   the user part of a SIP URI, or alternatively in an independent tel
   URI.  The certificate designated by the Identity-Info header field as
   specified, however, corresponds only to the domain portion of a SIP
   URI in the From header field.  As such, [RFC4474] does not have any
   provision to identify the assignee of a telephone number.  While it
   could be the case that the domain name portion of a SIP URI signifies
   a carrier (like "att.com") to whom numbers are assigned, the SIP
   Identity mechanism provides no assurance that a number is assigned to
   any carrier.  For a tel URI, moreover, it is unclear in [RFC4474]
   what entity should hold a corresponding certificate.

   This lack of authority gives rise to a whole class of SIP identity
   problems when dealing with telephone numbers, as is explored in
   [I-D.rosenberg-sip-rfc4474-concerns].  That document shows how the
   Identity header of a SIP request targeting a telephone number
   (embedded in a SIP URI) could be dropped by an intermediate domain,
   which then modifies and resigns the request, all without alerting the
   verification service: the verification service has no way of knowing
   which original domain signed the request.  Provided that the local
   authentication service is complicit, an originator can claim



Peterson, et al.       Expires November 27, 2013               [Page 10]

Internet-Draft        Secure Origin Identification              May 2013


   virtually any telephone number, impersonating any chosen Caller ID
   from the perspective of the verifier.  Both of these attacks are
   rooted in the inability of the verification service to ascertain a
   specific certificate that is authoritative for a telephone number.

   As deployed, SIP is moreover highly mediated, and mediated in ways
   that [RFC3261] did not anticipate.  As request routing commonly
   depends on policies dissimilar to [RFC3263], requests transit
   multiple intermediate domains to reach a destination; some forms of
   intermediaries in those domains may effectively re-initate the
   session.

   One of the main reasons that SIP deployments mimic the PSTN
   architecture is because the requirement for interconnection with the
   PSTN remains paramount: a call may originate in SIP and terminate on
   the PSTN, or vice versa; and worse still, a PSTN-to-PSTN call may
   transit a SIP network in the middle, or vice versa.  This necessarily
   reduces SIP's feature set to the least common dominator of the
   telephone network, and mandates support for telephone numbers as a
   primary calling identifier.

   Interworking with non-SIP networks makes end-to-end identity hugely
   problematic.  When a PSTN gateway sends a call to a SIP network, it
   creates the INVITE request anew, regardless of whether a previous leg
   of the call originated in a SIP network that later dropped the call
   to the PSTN.  As these gateways are not necessarily operated by
   entities that have any relationship to the number assignee, it is
   unclear how they could provide an identity signature that a verifier
   should trust.  Moreover, how could the gateway know that the calling
   party number it receives from the PSTN is actually authentic?  And
   when a gateway receives a call via SIP and terminates a call to the
   PSTN, how can that gateway verify that a telephone number in the From
   header field value is authentic, before it presents that number as
   the calling party number in the PSTN?

   Similarly, some SIP networks deploy intermediaries that act as back-
   to-back user agents (B2BUAs), typically in order to enforce policy at
   network boundaries (hence the nickname "Session Border Controller").
   As a common practice, these entities modify SIP INVITE requests in
   transit in such a way that they no longer satisfy the transaction-
   mapping semantics of [RFC3261], commonly changing the From, Contact
   and Call-ID header field values, as well as aspects of the SDP,
   including especially the IP addresses and ports associated with
   media.  The policies that motivate these changes may be associated
   with topology hiding, or may alter messages to interoperate
   successfully with particular SIP implementations, or may simply
   involve network address translation from private address space.  But
   effectively, a SIP request exiting a B2BUA has no necessary



Peterson, et al.       Expires November 27, 2013               [Page 11]

Internet-Draft        Secure Origin Identification              May 2013


   relationship to the original request received by the B2BUA, much like
   a request exiting a PSTN gateway has no necessary relationship to any
   SIP request in a pre-PSTN leg of the call.  An Identity signature
   provided for the original INVITE has no bearing on the post-B2BUA
   INVITE, and, were the B2BUA to preserve the original Identity header,
   any verification service would detect a violation of the integrity
   protection.

   The SIP community has long been aware of these problems with
   [RFC4474] in practical deployments.  Some have therefore proposed
   weakening the security constraints of [RFC4474] so that at least some
   deployments of B2BUAs will not violate (or remove) the integrity
   protection of SIP requests.  However, such solutions do not address
   the root problems identified above: the lack of any clear authority
   for telephone numbers, and the fact that some INVITEs are generated
   by intermediaries rather than endpoints.  Removing the signature over
   the SDP from the Identity header will not, for example, make it any
   clearer how a PSTN gateway should assert identity in an INVITE.

4.2.  VIPR

   Verification Involving PSTN Reachability (VIPR) directly attacks the
   twin problems of identifying number assignees on the Internet and
   coping with intermediaries that may modify signaling.  To address the
   first problem, VIPR relies on the PSTN itself: it discovers which
   endpoints on the Internet are reachable via a particular PSTN number
   by calling the number on the PSTN to determine whom a call to that
   number will reach.  As VIPR-enabled Internet endpoints associated
   with PSTN numbers are discovered, VIPR provides a rendez-vous service
   that allows the endpoints of a call to form an out-of-band connection
   over the Internet; this connection allows the endpoints to exchange
   information that secures future communications and permits direct,
   unmediated SIP connections.

   VIPR provides these services within a fairly narrow scope of
   applicability.  Its seminal use case is the enterprise IP PBX, a
   device that has both PSTN connectivity and Internet connectivity,
   which serves a set of local users with telephone numbers; after a
   PSTN call has connected successfully and then ended, the PBX searches
   a distributed hash-table to see if any VIPR-compatible devices have
   advertised themselves as a route for the unfamiliar number on the
   Internet.  If advertisements exist, the originating PBX then
   initiates a verification process to determine whether the entity
   claiming to be the assignee of the unfamiliar number in fact received
   the successful call: this involves verifying details such as the
   start and stop times of the call.  If the destination verifies
   successfully, the originating PBX provisions a local database with a
   route for that telephone number to the URI provided by the proven



Peterson, et al.       Expires November 27, 2013               [Page 12]

Internet-Draft        Secure Origin Identification              May 2013


   destination.  The destination moreover gives a token to the
   originator that can be inserted in future call setup messages to
   authenticate the source of future communications.

   Through this mechanism, the VIPR system provides a suite of
   properties, ones that go well beyond merely securing the origins of
   communications.  It also provides a routing system which dynamically
   discovers mappings between telephone numbers and URIs, effectively
   building an ad hoc ENUM database in every VIPR implementation.  The
   tokens exchanged over the out-of-band connection established by VIPR
   moreover provide an authorization mechanism for accepting calls over
   the Internet that significantly reduces the potential for spam.
   Because the token can act as a nonce due to the presence of this out-
   of-band connectivity, the VIPR token is less susceptible to cut-and-
   paste attacks and thus needs to cover with its signature far less of
   a SIP request.

   Due to its narrow scope of applicability, and the details of its
   implementation, VIPR has some significant limitations.  The most
   salient for the purposes of this document is that it only has bearing
   on repeated communications between entities: it has no bearing on the
   classic "robocall" problem, where the target receives a call from a
   number that has never called before.  All of VIPRs strengths in
   establishing identity and spam prevention kick in only after an
   initial PSTN call has been completed, and subsequent attempts at
   communication begin.  Every VIPR-compliant entity moreover maintains
   its own stateful database of previous contacts and authorizations,
   which lends itself more aggregators like IP PBXs that may front for
   thousands of users than to individual phones.  That database must be
   refreshed by periodic PSTN calls to determine that control over the
   number has not shifted to some other entity; figuring out when data
   has grown stale is one the challenges of the architecture.  As VIPR
   requires compliant implementations to operate both a PSTN interface
   and an IP interface, it has little apparent applicability to ordinary
   desktop PCs or similar devices with no ability to place direct PSTN
   calls.

   The distributed hash table also creates a new attack surface for
   impersonation.  Attackers who want to pose as the owners of telephone
   numbers can advertise themselves as routes to a number in the hash
   table.  VIPR has no inherent restriction on the number of entities
   that may advertise themselves as routes for a number, and thus an
   originator may find multiple advertisements for a number on the DHT
   even when an attack is not in progress.  As for attackers, even if
   they cannot successfully verify themselves to the originators of
   calls (because they lack the call detail information), they may learn
   from those verification attempts which VIPR entities recently placed
   calls to the target number: it may be that this information is all



Peterson, et al.       Expires November 27, 2013               [Page 13]

Internet-Draft        Secure Origin Identification              May 2013


   the attacker hopes to glean.  The fact that advertisements and
   verifications are public is rooted in the public nature of the DHT
   that VIPR creates.  The public DHT prevents any centralized control,
   or attempts to impede communications, but those come at the cost of
   apparently unavoidable privacy losses.

   Because of these limitations, VIPR, much like SIP Identity, has had
   little impact in the marketplace.  Ultimately, VIPR's utility as an
   identity mechanism is limited by its reliance on the PSTN, especially
   its need for an initial PSTN call to complete before any of VIPR's
   benefits can be realized, and by the drawbacks of the highly-public
   exchanges requires to create the out-of-band connection between VIPR
   entities.  As such, there is no obvious solution to providing secure
   origin services for SIP on the Internet today.  However, it seems
   like the fundamental principles embodied by SIP Identity and VIPR
   could still be viable, if they were staged in a slightly different
   manner.

5.  Environmental Changes

5.1.  Shift to Mobile Communication

   In the years since [RFC4474] was conceived, there have been a number
   of fundamental shifts in the communications marketplace.  The most
   transformative has been the precipitous rise of mobile smart phones,
   which are now arguably the dominant communications device in the
   developed world.  Smart phones have both a PSTN and an IP interface,
   as well as an SMS capability.  This suite of tools suggests that some
   of the techniques proposed by VIPR could be adapted to the smart
   phone environment.  The installed base of smart phones is moreover
   highly upgradable, and permits rapid adoption out-of-band rendezvous
   services for smart phones that circumvent the PSTN: for example, the
   Apple iMessage service, which allows iPhone users to send SMS
   messages to one another over the Internet rather than over the PSTN.
   Like VIPR, iMessage creates an out-of-band connection over the
   Internet between iPhones; unlike VIPR, the rendezvous service is
   provided by a trusted centralized database of iPhones rather than by
   a DHT.  While Apple's service is specific to customers of its smart
   phones, it seems clear that similar databases could be provided by
   neutral third parties in a position to coordinate between endpoints.

5.2.  Failure of Public ENUM

   At the time [RFC4474] was written, the hopes for establishing a
   certificate authority for telephone numbers on the Internet largely
   rested on public ENUM deployment.  The e164.arpa DNS tree established
   for ENUM could have grown to include certificates for telephone
   numbers, or at worst for number ranges.  It is now clear however that



Peterson, et al.       Expires November 27, 2013               [Page 14]

Internet-Draft        Secure Origin Identification              May 2013


   public ENUM as originally envisioned has little prospect for
   adoption.  That much said, national authorities for telephone numbers
   are increasingly migrating their provisioning services to the
   Internet, and issuing credentials that express authority for
   telephone numbers to secure those services.  This new class of
   certificate authority for numbers could be opened to the public
   Internet to provide the necessary signatory authority for securing
   calling partys' numbers.  While these systems are far from universal,
   the authors of this draft believe a certificate authority can be
   erected for the North American Numbering Plan in a way that numbering
   authorities for other country codes could follow.

5.3.  Public Key Infrastructure Developments

   Also, there have been a number of recent high-profile compromises of
   web certificate authorities.  The presence of numerous (in some
   cases, of hundreds) of trusted certificate authorities in modern web
   browsers has become a significant security liability.  As [RFC4474]
   relied on web certificate authorities, this too provides new lessons
   for any work on revising [RFC4474]: namely, that innovations like
   DANE that designate a specific certificate preferred by the owner of
   a DNS name could greatly improve the security of a SIP identity
   mechanism; and moreover, that when architecting new certificate
   authorities for telephone numbers, we should be wary of excessive
   pluralism.  While a chain of delegation with a progressively
   narrowing scope of authority (e.g., from a regulatory to a carrier to
   a reseller to an end user) is needed to reflect operational
   practices, there is no need to have multiple roots, or peer entities
   that both claim authority for the same telephone number or number
   range.

5.4.  Pervasive Nature of B2BUA Deployments

   Given the prevalence of established B2BUA deployments, we may have a
   further opportunity to review the elements signed by [RFC4474] and to
   decide on the worth of alternative signature mechanisms.  The ongoing
   efforts in the STRAW working group provide one possibility worth
   investigating for changes to the signed elements.  Separating the
   elements necessary for (a) securing the From header field value and
   preventing replays, from (b) the elements necessary to prevent men-
   in-the-middle from tampering with messages, may also yield a strategy
   for identity that will be practicable in some highly mediated
   networks.  It could be possible, for example, to provide two
   signatures: one over the elements required for (b), and then a
   separate signature over the elements necessarily for (a) and the
   signature over (b); this would allow verification services in
   mediated networks to ignore the failure of a (b) signature while
   still verifying (a).  Any solution along these lines must however



Peterson, et al.       Expires November 27, 2013               [Page 15]

Internet-Draft        Secure Origin Identification              May 2013


   always secure any cryptographic material necessary to support DTLS-
   SRTP or future security mechanisms.

5.5.  Stickiness of Deployed Infrastructure

   One thing that has not changed, and is not likely to change in the
   future, is the transitive nature of trust in the PSTN.  When a call
   from the PSTN arrives at a SIP gateway with a calling party number,
   the gateway will have little chance of determining whether the
   originator of the call was authorized to claim that calling party
   number.  Due to roaming and countless other factors, calls on the
   PSTN may emerge from administrative domains that have no relationship
   with the number assignee.  This use case will remain the most
   difficult to tackle for an identity system, and may prove beyond
   repair.  It does however seem that with the changes in the solution
   space, and a better understanding of the limits of [RFC4474] and
   VIPR, we are today in a position to reexamine the problem space and
   find solutions that can have a significant impact on the secure
   origins problem.

5.6.  Evolution with Numbering

   The assignment of telephone numbers may, in the future, no longer be
   restricted to entities that we traditionally consider "carriers", and
   will include administrative entities ranging from VSPs to end users,
   potentially.

6.  Requirements

   This section describes the high level requirements:

   Usability  Must work without human intervention

   Deployability  Must survive transition of the call to the PSTN and
      the presence of SBCs

   Consider existing structures  must allow number portability among
      carriers and must support legitimate usage of number spoofing
      (doctor's office and call centers)

   Minimal payload overhead  Must lead to minimal expansion of SIP
      headers (UDP) to avoid fragmentation in deployments that use with
      UDP

   Privacy  The out-of-band validation protocol must not allows third
      parties to learn what numbers had been called by a specific
      caller.




Peterson, et al.       Expires November 27, 2013               [Page 16]

Internet-Draft        Secure Origin Identification              May 2013


7.  Roadmap

   The authors of this document believe that the entire solution scope
   consists of a couple of separable aspects:

   In-band Caller ID Conveyance:  This functionality allows call origin
      identification information to be conveyed within SIP, and takes
      the nature of the E.164 numbers into account.  This is an revised
      version of the SIP Identity specification that takes E.164 numbers
      into account.  This approach considers the case where
      intermediaries do not strip-off header fields.

   Out-of-Band Caller ID Verification:  This functionality determines
      whether the E.164 number used by the calling party actually exists
      and whether a call has recently been made from this phone number.
      This approach is needed when the in-band technique does not work
      due to intermediaries or due to interworking with PSTN networks.

   Certificate Delegation Infrastructure:  This functionality defines
      how certificates with E.164 numbers are used in number
      portability, and delegation cases.  It also describes how the
      existing numbering infrastrufcture is re-used to maintain the
      lifecycle of number assignments.

   Extended Validation:  This functionality describes how to describes
      attributes of the calling party beyond the Caller ID and these
      attributes (e.g., the calling party is a bank) need to be verified
      upfront.

8.  Acknowledgments

   We would like to thank Alissa Cooper, Bernard Aboba, Sean Turner,
   Eric Burger, and Eric Rescorla for their discussion input that lead
   to this document.

9.  IANA Considerations

   This memo includes no request to IANA.

10.  Security Considerations

   This document is about improving the security of call origin
   identification.

11.  Informative References

   [10]       Krebs, B., "DHS Warns of 'TDoS' Extortion Attacks on
              Public Emergency Networks", URL: http://



Peterson, et al.       Expires November 27, 2013               [Page 17]

Internet-Draft        Secure Origin Identification              May 2013


              krebsonsecurity.com/2013/04/dhs-warns-of-tdos-extortion-
              attacks-on-public-emergency-networks/, Apr 2013.

   [11]       FCC, , "Robocalls", URL:
              http://www.fcc.gov/guides/robocalls, Apr 2013.

   [12]       FCC, , "FCC Robocall Challenge", URL:
              http://robocall.challenge.gov/, Apr 2013.

   [13]       Wikipedia, , "News International phone hacking scandal",
              URL: http://en.wikipedia.org/wiki/
              News_International_phone_hacking_scandal, Apr 2013.

   [1]        Peterson, J. and C. Jennings, "Enhancements for
              Authenticated Identity Management in the Session
              Initiation Protocol (SIP)", RFC 4474, August 2006.

   [2]        Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", RFC 3261,
              June 2002.

   [3]        Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", RFC 3261,
              June 2002.

   [4]        Jennings, C., Peterson, J., and M. Watson, "Private
              Extensions to the Session Initiation Protocol (SIP) for
              Asserted Identity within Trusted Networks", RFC 3325,
              November 2002.

   [5]        Elwell, J., "Connected Identity in the Session Initiation
              Protocol (SIP)", RFC 4916, June 2007.

   [6]        Cooper, A., Tschofenig, H., Peterson, J., and B. Aboba,
              "Secure Call Origin Identification", draft-cooper-iab-
              secure-origin-00 (work in progress), November 2012.

   [7]        Peterson, J., "Retargeting and Security in SIP: A
              Framework and Requirements", draft-peterson-sipping-
              retarget-00 (work in progress), February 2005.

   [8]        Rosenberg, J., "Concerns around the Applicability of RFC
              4474", draft-rosenberg-sip-rfc4474-concerns-00 (work in
              progress), February 2008.





Peterson, et al.       Expires November 27, 2013               [Page 18]

Internet-Draft        Secure Origin Identification              May 2013


   [9]        Rosenberg, J. and H. Schulzrinne, "Session Initiation
              Protocol (SIP): Locating SIP Servers", RFC 3263, June
              2002.

Authors' Addresses

   Jon Peterson
   NeuStar, Inc.
   1800 Sutter St Suite 570
   Concord, CA  94520
   US

   Email: jon.peterson@neustar.biz


   Henning Schulzrinne
   Columbia University
   Department of Computer Science
   450 Computer Science Building
   New York, NY  10027
   US

   Phone: +1 212 939 7004
   Email: hgs+ecrit@cs.columbia.edu
   URI:   http://www.cs.columbia.edu


   Hannes Tschofenig
   Nokia Siemens Networks
   Linnoitustie 6
   Espoo  02600
   Finland

   Phone: +358 (50) 4871445
   Email: Hannes.Tschofenig@gmx.net
   URI:   http://www.tschofenig.priv.at














Peterson, et al.       Expires November 27, 2013               [Page 19]
