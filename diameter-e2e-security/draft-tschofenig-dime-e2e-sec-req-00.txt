


DIME                                                  H. Tschofenig, Ed.
Internet-Draft                                               J. Korhonen
Intended status:  Standards Track                 Nokia Siemens Networks
Expires:  August 19, 2013                                        G. Zorn
                                                             Network Zen
                                                       February 15, 2013


       Diameter AVP Level Security: Requirements and Architecture
                draft-tschofenig-dime-e2e-sec-req-00.txt

Abstract

   This specification discusses requirements and architectural aspect
   for providing Diameter end-to-end security at the level of individual
   Attribute Value Pairs.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on August 19, 2013.

Copyright Notice

   Copyright (c) 2013 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Tschofenig, et al.       Expires August 19, 2013                [Page 1]

Internet-Draft         Diameter AVP Level Security         February 2013


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  4
   3.  Use Case . . . . . . . . . . . . . . . . . . . . . . . . . . .  5
   4.  Requirements . . . . . . . . . . . . . . . . . . . . . . . . .  6
   5.  Keying Database  . . . . . . . . . . . . . . . . . . . . . . .  7
   6.  Security Considerations  . . . . . . . . . . . . . . . . . . .  9
   7.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 10
   8.  Acknowledgments  . . . . . . . . . . . . . . . . . . . . . . . 11
   9.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 12
     9.1.  Normative References . . . . . . . . . . . . . . . . . . . 12
     9.2.  Informative References . . . . . . . . . . . . . . . . . . 12
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 13





































Tschofenig, et al.       Expires August 19, 2013                [Page 2]

Internet-Draft         Diameter AVP Level Security         February 2013


1.  Introduction

   The Diameter Base specification [1] offers security protection
   between neighboring Diameter peers and mandates that either TLS (for
   TCP), DTLS (for SCTP), or IPsec is used.  These security protocols
   offer a wide range of security properties, including entity
   authentication, data-origin authentication, integrity,
   confidentiality protection and replay protection.  They also support
   a large number of cryptographic algorithms, algorithm negotiation,
   and different types of credentials.

   The need to also offer additional security protection of AVPs between
   non-neighboring Diameter nodes was recognized very early in the work
   on Diameter.  This lead to investigations on a Diameter security
   extension using Cryptographic Message Syntax (CMS) [3].  Due to lack
   of deployment interest at that time the specification was, however,
   never completed.

   In the meanwhile Diameter had received a lot of deployment interest
   and due to the sophistication of those deployments the need for
   protecting Diameter AVPs between non-neighboring nodes re-surfaced.
   Since early 2000 when the work on [3] was discontinued the community
   had seen advances in cryptography and new requirements emerged.

   This document collects requirements for protecting Diameter AVPs.

      QUESTION:  What should the scope of the document be?  We could
      focus on requirements document or we could cover architectural
      aspects.  We are assuming that requirements for automatic key
      management are out of scope.  Is this proper scoping?





















Tschofenig, et al.       Expires August 19, 2013                [Page 3]

Internet-Draft         Diameter AVP Level Security         February 2013


2.  Terminology

   The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL', 'SHALL NOT',
   'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY', and 'OPTIONAL' in this
   specification are to be interpreted as described in [2].














































Tschofenig, et al.       Expires August 19, 2013                [Page 4]

Internet-Draft         Diameter AVP Level Security         February 2013


3.  Use Case

   Consider the following use case shown in Figure 1.  A Diameter client
   interacts with a Diameter server through two Diameter proxies.  The
   Diameter client and the Diameter Proxy A belong to the same realm,
   example.com.


   ****************************
                              *
      Realm: Example.com      *
   +--------+      +--------+ *      +--------+        +--------+
   |Diameter|      |Diameter| *      |Diameter|        |Diameter|
   |Client  +------+Proxy A +-*------+Proxy B +--------+Server  |
   +--------+      +--------+ *      +--------+        +--------+
       ^                      *                             ^
       .           End-to-End * Security Protection         .
       +......................*.............................+
                              *
   ****************************


               Figure 1: Example Diameter Deployment Setup.

   The Diameter AVPs are protected end-to-end, from the Diameter client
   to the Diameter server, as shown in Figure 1 with the dotted line.

   Other use cases are possible as well.  For example, Diameter Proxy A
   could act on behalf of the Diameter clients in the example.com realm.
   In a general case, however, encryption of AVPs between arbitrary
   Diameter nodes can be challenging since it is upfront not know what
   Diameter nodes a message will traverse.

      QUESTION:  Should the scope of the work be limited to provide data
      origin authentication, integrity, and optionally confidentially
      protection between of selected Diameter AVPs sent by the Diameter
      client to the Diameter server, and vice versa?














Tschofenig, et al.       Expires August 19, 2013                [Page 5]

Internet-Draft         Diameter AVP Level Security         February 2013


4.  Requirements

   Solutions MUST support an extensible set of cryptographic algorithms.

      Motivation:  Crypto-agility is the ability of a protocol to adapt
      to evolving cryptographic algorithms and security requirements.
      This may include the provision of a modular mechanism to allow
      cryptographic algorithms to be updated without substantial
      disruption to deployed implementations.

   Solutions MUST support replay protection.

   Solutions MUST support confidentiality, integrity, and data-origin
   authentication.

   Solutions MUST be able to selectively apply their cryptographic
   protection to certain Diameter AVPs.

   Solutions MUST recommend a mandatory-to-implement cryptographic
   algorithm.

      QUESTION:  Should solutions for integrity protection work in a
      backwards-compatible way with existing Diameter applications that
      support extensions?

      QUESTION:  Should we support symmetric keys or also asymmetric
      keys?

      QUESTION:  Should statically provisioned keys be supported as well
      or only automatic key management?  Should requirements for
      automatic key management also be covered in this document or in
      some other document?

      QUESTION:  Should the specification be written in such a way that
      it allows the provisioning of long-term shared symmetric
      credentials via a command-line interface / text file in an
      interoperable way?  This would allow simplified configuration.














Tschofenig, et al.       Expires August 19, 2013                [Page 6]

Internet-Draft         Diameter AVP Level Security         February 2013


5.  Keying Database

   Diameter nodes maintain different types of databases, depending on
   their functions.  Examples include the peer table and the routing
   table.  The usage of the security mechanisms described in this
   document adds another database to those nodes supporting this
   functionality.

   We describe the keying database in a conceptual way as a table, where
   each row represents a single symmetric key.

   The columns that the table consists of are listed as follows:

   LocalKeyName:  The LocalKeyName is a string identifying the key that
      has to be used for processing a received Diameter message.

   DestinationKeyName:  The DestinationKeyName on one system matches the
      LocalKeyName on the other system.  This field provides a protocol-
      specific set of restrictions on the scope in which the key is
      appropriate.  For example, this field is either a host or a realm
      in the format of a DiameterIdentity.

   KDF:  The KDF field indicates which key derivation function is used
      to generate short-lived keys from the long-lived value in the Key
      field.  When the long-lived value in the Key field is intended for
      direct use, the KDF field is set to "none".  This document
      establishes an IANA registry for the values in the KDF field to
      simplify references in future specifications.  The protocol
      indicates what (if any) KDFs are valid.

   AlgID:  The AlgID field indicates the cryptographic algorithm used
      with the security protocol.  The algorithm may be an encryption
      algorithm and mode (such as AES-128-CBC), an authentication
      algorithm (such as HMAC-SHA1-96 or AES-128-CMAC), or any other
      symmetric cryptographic algorithm needed by a security protocol.
      If the KDF field contains "none", then the long-lived key is used
      directly with this algorithm, otherwise the derived short-lived
      key is used with this algorithm.  When the long-lived key is used
      to generate a set of short-lived keys for use with the security
      protocol, the AlgID field identifies a ciphersuite rather than a
      single cryptographic algorithm.

   Key:  The Key field contains a long-lived symmetric cryptographic key
      in the format of a lower-case hexadecimal string.  The size of the
      Key depends on the KDF and the AlgID.  For instance, a KDF=none
      and AlgID=AES128 requires a 128-bit key, which is represented by
      32 hexadecimal digits.




Tschofenig, et al.       Expires August 19, 2013                [Page 7]

Internet-Draft         Diameter AVP Level Security         February 2013


   Direction:  The Direction field indicates whether this key may be
      used for inbound traffic, outbound traffic, both, or whether the
      key has been disabled and may not currently be used at all.  The
      supported values are "in", "out", "both", and "disabled",
      respectively.

   SendNotBefore:  The NotBefore field specifies the earliest date and
      time in Universal Coordinated Time (UTC) at which this key should
      be considered for use.  The format is YYYYMMDDHHSSZ, where four
      digits specify the year, two digits specify the month, two digits
      specify the day, two digits specify the hour, two digits specify
      the minute, and two digits specify the second.  The "Z" is
      included as a clear indication that the time is in UTC.

   SendNotAfter:  The SendNotAfter field specifies the latest date and
      time at which this key should be considered for use when sending
      messages.  The format is the same as the SendNotBefore field.

   RcvNotBefore:  The RcvNotBefore field specifies the earliest date and
      time in Universal Coordinated Time (UTC) at which this key should
      be considered for use when processing received messages.  The
      format is YYYYMMDDHHSSZ, where four digits specify the year, two
      digits specify the month, two digits specify the day, two digits
      specify the hour, two digits specify the minute, and two digits
      specify the second.  The "Z" is included as a clear indication
      that the time is in UTC.

   RcvNotAfter:  The RcvNotAfter field specifies the latest date and
      time at which this key should be considered for use when
      processing received traffic.  The format of this field is
      identical to the format of NotBefore.

   KeyManagement:  Specifies whether a entry was statically configured
      or dynamically discovered.

   Protocol:  The Protocol field identifies a single security protocol
      where this key may be used to provide cryptographic protection.

   ProtocolSpecificInfo:  This field contains the protocol-specified
      information which may be useful for a protocol to apply the key
      correctly.  Note that such information must not be required for a
      protocol to locate an appropriate key.









Tschofenig, et al.       Expires August 19, 2013                [Page 8]

Internet-Draft         Diameter AVP Level Security         February 2013


6.  Security Considerations

   This entire document focused on the discussion of new functionality
   for securing Diameter AVPs end-to-end.















































Tschofenig, et al.       Expires August 19, 2013                [Page 9]

Internet-Draft         Diameter AVP Level Security         February 2013


7.  IANA Considerations

   This document does not require actions by IANA.
















































Tschofenig, et al.       Expires August 19, 2013               [Page 10]

Internet-Draft         Diameter AVP Level Security         February 2013


8.  Acknowledgments

   Add your name here.
















































Tschofenig, et al.       Expires August 19, 2013               [Page 11]

Internet-Draft         Diameter AVP Level Security         February 2013


9.  References

9.1.  Normative References

   [1]  Fajardo, V., Arkko, J., Loughney, J., and G. Zorn, "Diameter
        Base Protocol", RFC 6733, October 2012.

   [2]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", BCP 14, RFC 2119, March 1997.

9.2.  Informative References

   [3]  Calhoun, P., Farrell, S., and W. Bulley, "Diameter CMS Security
        Application", draft-ietf-aaa-diameter-cms-sec-04 (work in
        progress), March 2002.




































Tschofenig, et al.       Expires August 19, 2013               [Page 12]

Internet-Draft         Diameter AVP Level Security         February 2013


Authors' Addresses

   Hannes Tschofenig (editor)
   Nokia Siemens Networks
   Linnoitustie 6
   Espoo  02600
   Finland

   Phone:  +358 (50) 4871445
   Email:  Hannes.Tschofenig@gmx.net
   URI:    http://www.tschofenig.priv.at


   Jouni Korhonen
   Nokia Siemens Networks
   Linnoitustie 6
   FI-02600 Espoo
   FINLAND

   Email:  jouni.nospam@gmail.com


   Glen Zorn
   Network Zen
   227/358 Thanon Sanphawut
   Bang Na  Bangkok 10260
   Thailand

   Email:  glenzorn@gmail.com






















Tschofenig, et al.       Expires August 19, 2013               [Page 13]

